::: {.content-hidden}

Copyright (C) 2025 Mixignal Innovations LLC. All rights reserved.

This work is licensed under the Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License (the "License"). You may share and adapt this material for non-commercial purposes, provided you give appropriate credit to the original author, indicate if changes were made, and distribute your contributions under the same License.

You may obtain a copy of the License at

   https://creativecommons.org/licenses/by-nc-sa/4.0/.

You can contact the publisher at info@mixignal.com


:::

::: {.content-hidden}
TASKS:

* Add the KCL and KVL figures 

:::

# Linear Circuits {#chap-linear-ckts}

This chapter assumes the reader knows basic linear circuit analysis and needs a refresher. We focus on key techniques like linearity properties, Thevenin-Norton equivalents, and interface circuit design.


## Basic Circuit Analysis {#sec-linear-ckts-basics}

 **PASSIVE DEVICE** (R,L,C)  $I-V$ characteristics has been derived. Although these devices are often non-linear in practice, we will use their linear models, known as _circuit elements_, and apply the following linear equations:

 $$Resistor: v = iR$$

 also known as Ohm's law,
 
 $$Capacitor: i = C\frac{dv}{dt}$$

 $$Inductor: v = L \frac{di}{dt}$$

 The capacitor and inductor are non-dissipative devices but resistor is not, and the power dissipated by it is given by

 $$ p = v^2/R$$


 or,

 $$ p = i^2 R$$

::: {.callout-tip title="Excercise: Power and current calculation"}
Determine the current flowing through a $3.3 k\Omega$ resistor when $3.3 V$ is applied across it, and calculate the power it dissipates.
:::


::: {.callout-tip title="Excercise: Linear range calculation"}
A resistor remains linear when voltage and current are within its power rating limits. For a $10~k\Omega$ resistor with a power rating of $0.25 W$, determine the maximum current and voltage to keep it within its linear range
:::


**IDEAL SOURCES** are essential for electronic circuits to function and are represented by two elements: voltage sources and current sources.

The $i–v$ characteristic of an **ideal voltage source** is described by the following element equations:

$$ v=v_s \text{ and } i=\text{any value}$$

where, $v_s$ is voltage across the source and $i$ is the current flowing through it.

The $i–v$ characteristic of an **ideal current source** is described by the following element equations:

$$ i=i_s \text{ and } v=\text{any value}$$

where, $s_s$ is the current flowing through the source and $v$ is the voltage across it.

In circuit analysis, the voltage or current from ideal sources is called a **forcing** or **driving** function, as it triggers a circuit response. Time-varying voltage or current is typically denoted as $v(t)$ or $i(t)$.


**CONNECTION CONSTRAINTS** are activated when devices are connected within a circuit. Two essential principles governed by connection constraints are Kirchhoff's current law (KCL) and Kirchhoff's voltage law (KVL).

### Kirchhoff‘s Current Law (KCL)

Kirchhoff's first law is founded on the conservation of charge principle. Kirchhoff's current law (KCL) asserts that

::: {.callout-note title="Kirchhoff‘s Current Law (KCL)"}

**the algebraic sum of the currents entering a node is zero at every instant**.

:::

When summing currents algebraically, consider each device's reference direction: assign a positive sign if directed into the node, and a negative sign if directed away.

![Circuit for demonstrating KCL](figures/fig-circuits-KCL.png){#fig-circuits-kcl}

Applying this convention to the nodes in @fig-circuits-kcl, we obtain the following set of KCL connection equations:

$$\text{Node A: } -i_1 - i_2 = 0$$
$$\text{Node B: } i_1 - i_3 - i_4 + i_5= 0$$
$$\text{Node C: } i_2 + i_3 + i_4 - i_5= 0$$

The KCL equation at node A indicates that the reference direction for currents $i_1$ and $i_2$ is away from node A, not that they are negative. Similarly, the equation at node B could be expressed as

$$
i_1  + i_5 =  i_3 + i_4
$$


This example demonstrates a different formulation of KCL:

> **The sum of the currents entering a node equals the sum of the currents leaving the node**.

Another general principle that can be easily derived from KCL:

> **In a circuit containing a total of N nodes, there are only $N – 1$ independent KCL connection equations**.

The current equations specified at $N – 1$ nodes encapsulate all the independent connection constraints derivable from the Kirchhoff's Current Law (KCL).

::: {.callout-note title="Equivalent circuits"}

Note that the three parallel elements in @fig-circuits-kcl can be replaced by one _equivalent_ element, which can generally be stated as:

> **Two circuits are said to be equivalent if they have identical $i–v$ characteristics at a specified pair of terminals.**

For example, if the 3 elements were resistors $R_1, R_2, R_3$, they can be replaced with an equivalent resistor of value $R_1R_2R_3/(R_1+R_2+R_3)$.
 
:::

### Kirchhoff's Voltage Law (KVL)

Kirchhoff's second circuit law is rooted in the energy conservation principle. According to the Kirchhoff voltage law (KVL),

::: {.callout-note title="Kirchoff's Voltage Law (KVL)"}
**the algebraic sum of all voltages around a loop is zero at every instant**.
:::

![Circuit for demonstrating KVL](figures/fig-circuits-KVL.png){#fig-circuits-kvl}

Three loops in @fig-circuits-kvl show the circuit. A voltage receives a positive sign when moving from “+” to “–” and a negative sign from “–” to “+.” The loop's clockwise traversal gives these KVL equations.

$$ \text{Loop 1: } -v_1 + v_2 + v_3 = 0 $$
$$ \text{Loop 2: } -v_3 + v_4 + v_5 = 0 $$
$$ \text{Loop 3: } -v_1 + v_2 + v_4 + v_5 = 0 $$

Two signs are linked to each voltage. The first sign is used when formulating the KVL connection equation. The second sign depends on the real polarity of the voltage compared to its designated reference polarity.

A general principle can be derived from KVL :

> **For a circuit that includes $E$ number of two-terminal elements and has $N$ nodes, only $E - N + 1$ independent Kirchhoff's Voltage Law (KVL) equations can be formed.**

::: {.callout-note title="A note on assigning voltage polarities and current direction "}

 When voltage polarities or current directions are missing in a circuit diagram, they need to be set arbitrarily before analysis. These assignments don't reflect the actual circuit conditions. If the assumed direction and polarities match the actual ones, the response's sign will be positive; otherwise, it will be negative.
 
 > **In other words, the sign of the answer together with the assigned polarities and directions tells us the actual voltage polarity or current direction. **

In the passive sign convention, we can choose either the + voltage reference or the current reference arrow for a two-terminal element, but not both simultaneously. Once the voltage reference is set, the current arrow must enter the terminal with the + mark. Conversely, if the current reference is chosen first, the + voltage reference is applied to the same terminal.

:::


## Circuit Analysis Techniques

We can apply Ohm’s and Kirchhoff’s laws to develop two key circuit analysis techniques: nodal analysis, using Kirchhoff's current law (KCL) and mesh analysis, using Kirchhoff’s voltage law (KVL). These techniques are crucial to any circuit analysis. By developing these methods, we can analyze almost any circuit by forming and solving simultaneous equations to find currents or voltages. One solution for these equations is Cramer's rule, which calculates circuit variables using determinant quotients.


### Nodal Analysis

Nodal analysis, or node-voltage analysis, analyzes circuits by using node voltages as variables, simplifying the process and reducing the number of simultaneous equations. It focuses on determining node voltages and follows three steps for a circuit with n nodes without voltage sources.


::: {.callout-note title="Steps to determine node voltage"}

1. Select a reference node. Assign a voltage $v_1, v_2, \ldots , v_{n-1}$ to the remaining $N– 1$ nodes.

2. Apply KCL to each of the $N-1$ non-reference nodes. Use Ohm’s law to express the branch currents in terms of node voltages.

3. Solve the resulting simultaneous equations to obtain the unknown node voltages.

:::

![Circuit for demonstrating node-voltage analysis](figures/fig-circuits-nodev.png){#fig-circuits-nodev}

The circuit in @fig-circuits-nodev illustrates node-voltage equation formulation, identifying a reference node (ground), four currents ($i_0$, $i_1$, $i_2$, $i_3$), and two node voltages ($v_A$, $v_A$).

At the two nodes that are not used as references, the KCL constraints can be stated as follows:

$$ \text{Node A: } -i_0-i_1-i_2 = 0$$
$$ \text{Node B: } i_2-i_3 = 0$$

By applying the core principles of node analysis, we can connect element currents with node voltages through the corresponding element equations.

$$\text{Resistor} R_1\text{: } i_1 = \frac{v_A}{R_1} $$
$$\text{Resistor} R_2\text{: } i_2 = \frac{v_A-v_B}{R_2} $$
$$\text{Resistor} R_3\text{: } i_3 = \frac{v_B}{R_3} $$
$$\text{Current source: } i_0 = -i_S $$

We formulate six equations for six unknowns, four currents of the element, and two node voltages. The right side of these equations involves unknown node voltages and the input signal $i_S$. By substituting device constraints into the KCL equation and rearranging terms, we derive the following standard form:

$$ \text{Node A: } \left({\frac{1}{R_1}+\frac{1}{R_2}}\right) v_A - \frac{v_B}{R_2} = i_S$$
$$ \text{Node B: } \frac{v_A}{R_2} + \left({\frac{1}{R_2}+\frac{1}{R_3}}\right) v_B = 0$$

In this standard form, unknown node voltages are on one side, and independent sources on the other, easing analysis. By eliminating element currents, the circuit is reduced to two linear equations with two unknown node voltages.

The node-voltage method simplifies solving to $N– 1$ equations. With $E$ elements, the reduction from $2E$ to $N– 1$ is notable in circuits having many elements ($E$) interconnected in parallel ($N$).


::: {.callout-note title="Nodal Analysis with voltage sources"}

Two methods to handle voltage sources in nodal analysis: 1) Set one node as the reference node, 2) Form a supernode with both nodes to apply KCL, ensuring the voltage across it equals the source voltage.

:::

::: {.callout-note title="Solving linear algebraic equations"}

The linear equation system derived from node analysis is solvable using either manual calculations or computer-aided approaches. An integrated circuit (IC) engineer should be proficient in both methods. For lower complexity problems with numerical coefficients, techniques such as Cramer's Rule or Gaussian Elimination can be applied [@thomas_analysis_2016], [@alexander_fundamentals_2007].

As the complexity of the problem rises, employing a programming language such as Python or a circuit simulator like ngspice becomes more efficient.

:::


### Mesh Analysis

Mesh analysis is a method for analyzing circuits using mesh currents as variables, simplifying equations by using these currents instead of element currents. A loop is a closed path passing each node once, while a mesh is a loop without any smaller loops inside.
Nodal analysis uses KCL to find unknown voltages, while mesh analysis uses KVL to find unknown currents. Mesh analysis is less general than nodal analysis as it only applies to planar circuits, which can be drawn without crossing branches. Circuits with crossing branches may still be planar if they can be redrawn without them.

A circuit with $n$ meshes can be analyzed using three steps:

::: {.callout-note title="Steps to determine mesh current"}

1. Assign mesh currents $i_1, i_2, \ldots i_n$ to the $n$ meshes.

2. Apply KVL to each of the $n$ meshes using Ohm's law to express voltages in terms of the mesh currents.

3. Solve the resulting $n$ simultaneous equations to get the mesh currents. 

:::

![A circuit with two meshes](figures/fig-circuits-meshi.png){#fig-circuits-meshi}

Refer to @fig-circuits-meshi, where mesh currents $i_1$ and $i_2$ are assigned clockwise by convention, though any direction is possible. Applying KVL to each mesh, we obtain

$$ (R_1+R_3)i_1 - R_3i_2 = V_1$$
$$ -R_3i_1 + (R2+R_3)i_2 = -V_2$$

Now we can solve the simultaneous equations using the techniques of our choice. 

::: {.callout-note title="Mesh Analysis with current sources"}

Similar to nodal analysis with voltage sources, two methods to handle current sources in mesh analysis: 1) When a current source exists only in one mesh, the mesh current is simply set to the current value of the current source, 2) When a current source exists between two meshes, create a supermesh such that KVL can be applied to it.

:::


### What are Linear Circuits?

The analyses conducted up to this point, as well as those we will conduct in the future, pertain to linear circuits. Therefore, it's beneficial to understand the definition of linear circuits. Briefly, a linear circuit adheres to the principles of linearity, namely **homogeneity** and **additivity**. 
Mathematically, these properties can be expressed as:

$$ f(Kx) = Kf(x) $$ (homogeneity)

where $K$ is a scalar constant with the homogeneity property also known as **proportionality**, and

$$ f(x_1+x_2) = f(x_1) + f(x_2)$$ (additivity)

where the additive property is also known as **superposition**

::: {.callout-note}

The superposition and proportionality principle is also employed to assess the linearity of a circuit. For instance, in the case of a two-terminal circuit whose linearity is uncertain, we can utilize linearity principles to ascertain this property.

:::


