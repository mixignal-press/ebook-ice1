<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>4&nbsp; Semiconductor IC devices – IC Engineering I</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./references.html" rel="next">
<link href="./circuits.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-924744db78ae1b09cc9bed16d2855edb.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./devices.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Semiconductor IC devices</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">IC Engineering I</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./passives.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Passive IC devices</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./circuits.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Linear Circuits</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./devices.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Semiconductor IC devices</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-semi-dev-intro" id="toc-sec-semi-dev-intro" class="nav-link active" data-scroll-target="#sec-semi-dev-intro"><span class="header-section-number">4.1</span> Introduction</a></li>
  <li><a href="#sec-semi-dev-band" id="toc-sec-semi-dev-band" class="nav-link" data-scroll-target="#sec-semi-dev-band"><span class="header-section-number">4.2</span> Energy Band Model</a></li>
  <li><a href="#carriers" id="toc-carriers" class="nav-link" data-scroll-target="#carriers"><span class="header-section-number">4.3</span> Carriers</a></li>
  <li><a href="#band-diagrams" id="toc-band-diagrams" class="nav-link" data-scroll-target="#band-diagrams"><span class="header-section-number">4.4</span> Band Diagrams</a></li>
  <li><a href="#doping" id="toc-doping" class="nav-link" data-scroll-target="#doping"><span class="header-section-number">4.5</span> Doping</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="chap-semi-dev" class="quarto-section-identifier"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Semiconductor IC devices</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="sec-semi-dev-intro" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="sec-semi-dev-intro"><span class="header-section-number">4.1</span> Introduction</h2>
<p>The large-scale integration of electronic circuits is rooted in the invention and evolution of semiconductor devices. We will discuss electronic materials to explain the fundamental properties of semiconductors in IC design and their role in the success of integrated circuits.</p>
<div id="tbl-devices-rho" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-devices-rho-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4.1: Specific resistance (at <span class="math inline">\(20^\circ C\)</span>) of typical metals used in integrated circuits expressed in <span class="math inline">\(\Omega cm\)</span> and, the unit resistance of a height of <span class="math inline">\(1\mu m\)</span> metal expressed in <span class="math inline">\(\Omega/\square\)</span>
</figcaption>
<div aria-describedby="tbl-devices-rho-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th><span class="math inline">\(\mu -\Omega\)</span> cm</th>
<th><span class="math inline">\(m\Omega/\square\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Al</td>
<td>2.65</td>
<td>26.5</td>
</tr>
<tr class="even">
<td>Cu</td>
<td>1.68</td>
<td>16.8</td>
</tr>
<tr class="odd">
<td>Au</td>
<td>2.44</td>
<td>24.4</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>The fundamental materials in integrated circuits include metals, dielectrics, and semiconductors. Metals are used as conductors for interconnects because of their extremely low specific resistivity. <em>Specific resistivity</em> (<span class="math inline">\(\rho\)</span>) is a property of the material that can be defined as <em>resistance per unit volume</em> expressed in SI units of <span class="math inline">\(\Omega m\)</span> but more conveniently as <span class="math inline">\(\Omega cm\)</span>. The resistance of a rectangular piece of that material can be expressed as <span class="math inline">\(R=\rho\cdot l/A\)</span>, where <span class="math inline">\(l\)</span> is the length and <span class="math inline">\(A\)</span> is the cross-sectional area. In integrated circuit design, the height of the metal routing is fixed and is typically in the range of <span class="math inline">\(0.1\)</span> to <span class="math inline">\(5\)</span> micrometers (<span class="math inline">\(\mu m, 10^{-6} m)\)</span> and the resistance is measured in unit squares as or <span class="math inline">\(\Omega/\square\)</span>. The specific resistance (in <span class="math inline">\(\Omega cm\)</span>) and unit resistance (in <span class="math inline">\(\Omega/\square\)</span>) of typical metals used in integrated circuits such as aluminum (Al), copper (Cu) and gold (Au) are tabulated in <a href="#tbl-devices-rho" class="quarto-xref">Table&nbsp;<span>4.1</span></a>. Dielectric materials have extremely large specific resistances that provide electrical insulation for typical operating conditions. Specific resistances for semiconductors can vary enormously <span class="math inline">\(-\)</span> from <span class="math inline">\(10^{-4} ~\Omega cm\)</span> to <span class="math inline">\(10^{12} ~\Omega cm\)</span>.</p>
<p>The history of semiconductors began with Tomas Seebeck’s observation of lead sulfur (PbS) properties in 1821. Michael Faraday noted that semiconductor resistance decreases with rising temperatures, unlike conductors. Early applications include Werner von Siemens’ selenium photometer (1875) and Alexander Graham Bell’s wireless device (1878). The pivotal discovery of the Bipolar Junction Transistor (BJT) by Shockley, Bardeen, and Brattain in 1947 led to today’s integrated circuits with millions of devices in a single IC.</p>
<p>Electronic systems operate using a power supply formed by non-electric forces that separate charges to create a <strong>potential difference</strong>. Chemical forces generate batteries, while turbines produce AC, which is converted to DC voltages. This potential difference forms an electric field, driving current in the circuit. Manipulating this current with semiconductor devices in an integrated circuit is essential for intelligent systems like modern computers..</p>
<p>Semiconductor devices excel in integrated circuits due to their rapid conductivity changes, small size, and low energy use. They are manufactured at nanometer scales with switching speeds of 100 gigahertz, consuming nanowatts of power. Their conductivity can shift dramatically from insulator to conductor, representing digital <em>zeros</em> and <em>ones</em>. Understanding semiconductors like silicon involves studying the physics of their conductivity changes, which vary significantly with temperature as well.</p>
<p>Some excellent references for this subject matter are <span class="citation" data-cites="shur_introduction_1996">(<a href="references.html#ref-shur_introduction_1996" role="doc-biblioref">Shur 1996</a>)</span>, <span class="citation" data-cites="pierret_semiconductor_1996">(<a href="references.html#ref-pierret_semiconductor_1996" role="doc-biblioref">Pierret 1996</a>)</span>, and <span class="citation" data-cites="streetman_solid_2014">(<a href="references.html#ref-streetman_solid_2014" role="doc-biblioref">Streetman and Banerjee 2014</a>)</span>.</p>
</section>
<section id="sec-semi-dev-band" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="sec-semi-dev-band"><span class="header-section-number">4.2</span> Energy Band Model</h2>
<p>The energy band model explains the conduction properties of matter easily that we will introduce now using <em>quantum mechanical properties of matter</em>. Instead of explaining the model for a semiconductor crystal such as silicon, the basic principles can be explained using a much simpler atomic system, the <em>isolated hydrogen atom</em>. During the 1900s, the emission spectrum of heated gases did not agree with the contemporary physical model of continuous electron energy. In order to reconcile the discrepancy, in 1913 Neils Bohr proposed that the electrons can have only certain discrete allowed energy levels, called <strong>energy states</strong>.</p>
<p>For hydrogen atom the quantization of energy states is <span class="math inline">\(E_n = -E_B/n^2\)</span> where <span class="math inline">\(n = 1,2,3,4,\ldots\)</span> is called the <em>energy quantum number</em> and <span class="math inline">\(E_B\)</span> is called the <em>Bohr energy</em> or the <em>electron binding energy</em>.</p>
<p>For hydrogen atom, Bohr energy <span class="math inline">\(E_B = 13.6 eV/n^2\)</span></p>
<p>Electron energies are expressed in <em>electron volt</em> (eV), the work done to move an electron across a potential difference of <span class="math inline">\(1~V\)</span>.</p>
<p>[<span class="math inline">\(1~eV = q\times 1V = 1.602\times 10^{-19} Joule\)</span>]</p>
<div id="fig-semi-dev-band" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-semi-dev-band-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/fig-semi-dev-band.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-semi-dev-band-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.1: Conceptual development of the energy band model starting with N isolated Si atoms on the top left, then showing the split bands for Crytalline SI N-atoms and concluding, at bottom right, with the popular version of the energy band model.
</figcaption>
</figure>
</div>
<p>Let us now study the many electron energies of a Si crystal (Si), which is more complicated, but the basic principles still apply. The concept of <em>band diagrams</em> can be qualitatively conceived by starting with N-isolated Si atoms and observing the energy states as the atoms are brought closer and closer together (see <a href="#fig-semi-dev-band" class="quarto-xref">Figure&nbsp;<span>4.1</span></a>). <em>Pauli exclusion principle</em> plays an important role in determining energy states as the atoms are brought closer. The principle states that no more than two electrons can occupy each energy state. In a solid material, as many atoms (N) are brought closer, the energy states start to split to satisfy the exclusion principle. At the interatomic spacing of the lattice, the split energy levels form essentially continuous <em>energy bands</em>. However, these bands are separated by <em>forbidden energy gaps</em> that cannot be occupied by any electron. The magnitude of the forbidden energy gaps determines primarily the electrical properties of different materials. In filling the allowed energy states, electrons tend to gravitate to the lowest possible states. At room temperature in semiconductors and dielectrics, almost all of the states in the lower energy bands are filled by electrons, and the higher energy states are mostly empty. The upper band of the allowed states is called the <em>conduction band</em>; the lower band of the allowed states is called the <em>valence band</em>; and the gap between the two bands without any allowed energy states, the <em>forbidden band</em> or the <em>energy band gap</em>. An electron in the valence band needs energy equal to or greater than the energy band gap to transition from the valence band to the conduction band.</p>
<div id="fig-semi-dev-class" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-semi-dev-class-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/fig-semi-dev-class.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-semi-dev-class-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.2: Illustration of the distinction between (a) insulator, (b) semiconductor, and (c) metal.
</figcaption>
</figure>
</div>
<p>Typically, for semiconductors, the energy band gap, <span class="math inline">\(E_g\)</span>, varies between <span class="math inline">\(0.1~eV\)</span> and <span class="math inline">\(3.5~eV\)</span>.</p>
<p>At room temperature (T=300K), <span class="math inline">\(E_G=1.42eV\)</span> (GaAs), <span class="math inline">\(E_G=1.12eV\)</span> (Si), and <span class="math inline">\(E_G=0.66eV\)</span> (Ge).</p>
<p>In dielectric, the energy band gap is large and so the valence bands are completely filled and the conduction band is totally void of electrons making them perfect insulators. Typically for dielectrics, <span class="math inline">\(E_g\)</span> is larger than <span class="math inline">\(5~eV\)</span> (diamond) to <span class="math inline">\(8~eV~(SiO_2)\)</span>. In a metal, the lowest conduction band is partially filled with many electrons, making it an ideal conductor.</p>
</section>
<section id="carriers" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="carriers"><span class="header-section-number">4.3</span> Carriers</h2>
<p>Carriers are the current-carrying entities within the semiconductor material and we are now in a position to introduce them, the semiconductor model having been well established. Referring to our bonding model, there are no carriers or possible current flow if no bonds are broken in the semiconductor solid. In the energy band model, this refers to a valence band which is <em>completely</em> filled with electrons and a conduction band which is completely devoid of electrons. This will be the case for a <em>pure</em> semiconductor like a silicon crystal at temperature <span class="math inline">\(T=0^\circ K\)</span>. Now, for an electron to carry current under the influence of an applied electric field, it has to break free from the bond, for example, the Si-Si bond. In terms of the energy band model, this refers to an electron from the valence band jumping over to the conduction band creating <em>carriers</em>; that is, <em>electrons in the conduction band are carriers</em>. Note that the energy required to break a bond is the same as the forbidden energy gap <span class="math inline">\(E_G\)</span>.</p>
<div id="fig-semi-dev-carrierviz" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-semi-dev-carrierviz-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/fig-semi-dev-carrierviz.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-semi-dev-carrierviz-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.3: Visualization of carriers using the bonding model (left) and the energy band model (right) (a) No-carrier situation; (b) visualization of an electron; (c ) visualization of a hole
</figcaption>
</figure>
</div>
<p>The <em>average thermal energy of an electron</em>, in equilibrium, is equal to <span class="math inline">\(3k_BT/2\)</span> where, <span class="math inline">\(k_B\)</span> is the Boltzmann constant and <span class="math inline">\(T\)</span> is the temperature in degrees Kelvin. The generally accepted room temperature is <span class="math inline">\(27^\circ C\)</span> or <span class="math inline">\(300~K\)</span>.</p>
<p><span class="math inline">\(k_BT = 1.38\times 10^{-23} \frac{J}{K} \times 300~K = 0.026~eV\)</span></p>
<p>This energy is attributed to the electron’s thermal motion inside the crystal lattice that can be explained accurately using quantum mechanics. But an <em>effective mass</em> formulation is a simplified <em>classical</em> way of explaining the same phenomenon. This allows us to formulate the carriers as <em>quasi-classical particles</em> and employ classical particle relationships in most device analyzes. Using this formulation, the average thermal energy can be attributed to the average kinetic energy <span class="math inline">\(m^*_n v_{th}^2/2\)</span> where <span class="math inline">\(m^*_n\)</span> is the <em>effective electron mass</em> and <span class="math inline">\(v_{th}\)</span> is called the electron <em>thermal velocity</em>.</p>
<p>The electron effective mass <span class="math inline">\(m^*_n\)</span> is different from the free electron mass <span class="math inline">\(m^*_e\)</span> which is <span class="math inline">\(9.11\times 10^{-31}kg\)</span>. For example, in silicon, <span class="math inline">\(m^*_n\approx 0.066~m_e\)</span>.</p>
<p>However, <span class="math inline">\(3k_BT/2\)</span> is just the average energy, and the actual energies of an individual electron vary widely. A few electrons acquire enough thermal energy to jump into the conduction band.</p>
<p>Energy gap <span class="math inline">\(E_G\)</span> of silicon (Si) is <span class="math inline">\(\approx 1.12 ~eV\)</span> which is approximately 45 times larger than <span class="math inline">\(k_BT\)</span> at room temperature!</p>
<p>Since there can be no current in the absence of an electric field, the random motions of the electrons compensate for each other. In the presence of an electric field, in addition to random motions, the electrons seem to drift in the direction of the electric with a so-called <em>drift velocity</em> which results in an electric current.</p>
<p>Now let us look at a phenomenon, unique to semiconductors, when an electron breaks <em>free</em> from a bond. It leaves a <em>vacancy</em> for another electron to break free from its bond and occupy this vacancy which in turn leaves another vacancy and so on leading to an <em>appearance</em> of a motion of a vacant electron of a <em>positive</em> charge <span class="math inline">\(q=-(-q)\)</span> and an effective mass of <span class="math inline">\(m^*_p\)</span>. This motion is typically represented as a fictitious particle called a <em>hole</em>. This phenomenon can be imagined as analogous to the <em>bubble in a fluid</em>. In terms of the energy band model, jumping an electron to the conduction band creates a <em>hole</em> in an otherwise vast sea of filled states. This empty state, like a bubble in a fluid, moves about rather freely in the solid because of the cooperative motion of valence-band electrons that give room to this hole in motion. Like a free electron carrier, when an electric field is applied to this semiconductor, the hole, an apparent <em>positive electron</em>, will move in the direction of the electric field, giving rise to electric current.</p>
<div id="fig-semi-dev-carrier-efield" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-semi-dev-carrier-efield-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/fig-semi-dev-carrier-efield.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-semi-dev-carrier-efield-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.4: Electrons move in an electric field. The band diagrams are like <a href="#fig-semi-dev-class" class="quarto-xref">Figure&nbsp;<span>4.2</span></a>, but with an expanded energy scale showing closely packed levels, each accommodating two electrons. Solid circles show electrons in a level; open circles indicate available levels.
</figcaption>
</figure>
</div>
</section>
<section id="band-diagrams" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="band-diagrams"><span class="header-section-number">4.4</span> Band Diagrams</h2>
<p>Band diagrams are a very efficient way of illustrating electrical properties of semiconductor materials and devices without going into the detail atomic or molecular structure of the material. As shown in <a href="#fig-semi-dev-carrier-efield" class="quarto-xref">Figure&nbsp;<span>4.4</span></a>, the band diagram represents the electrical energies allowed within the semiconductor as a function of position, where the increase in energy <span class="math inline">\(E\)</span> upward represents the total energy of electrons. The <em>charge carriers</em> or <em>free charge carriers</em> start to occupy the lowest energy states in the conduction band which are <em>lower edge of the conduction band</em> (<span class="math inline">\(E_C\)</span>) and <em>upper edge of the valence band</em> (<span class="math inline">\(E_V\)</span>) for <em>electrons</em> and <em>holes</em>, respectively.</p>
<p>Therefore, to analyze or understand the electrical behavior of a <em>uniform</em> semiconductor material it is typically sufficient to study the material properties with the <em>band edges</em> only. Normal operation is assumed here without any external disturbances, where the electric field, magnetic field, temperature gradient, and stress-induced effects are negligible.</p>
<div id="fig-semi-dev-band-electrostatic" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-semi-dev-band-electrostatic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/fig-semi-dev-band-electrostatic.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-semi-dev-band-electrostatic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.5: Relationship between band bending and electrostatic variables in a semiconductor: (a) energy band diagram showing band bending; (b) identification of carrier kinetic energies; (c) electron potential energy; (d) electrostatic potential; (e) electric field vs.&nbsp;position from part (a).
</figcaption>
</figure>
</div>
<p>On careful examination of the band diagram, we can show that an energy equal to the <em>bandgap</em>, <span class="math inline">\(E_G = E_C-E_V\)</span>, is required to break an atomic bond to create <em>motionless</em> electrons and holes occupying <span class="math inline">\(E_C\)</span> and <span class="math inline">\(E_V\)</span>, respectively. Therefore, we can interpret the edges of the band <span class="math inline">\(E_C\)</span> and <span class="math inline">\(E_V\)</span> as the potential energy of the electron and hole, respectively, with reference to an arbitrary energy level <span class="math inline">\(E_{ref}\)</span>.</p>
<p>Potential Energy: <span class="math inline">\(P.E.=E_C-E_{ref}\)</span> NOTE: Show PE and KE on the diagram itself.</p>
<p>Any energy in excess of <span class="math inline">\(E_G\)</span> will result in the kinetic energy shown in figure <a href="#fig-semi-dev-band-electrostatic" class="quarto-xref">Figure&nbsp;<span>4.5</span></a>, with the carriers moving rapidly in the lattice. The potential energy is the key to relating the positional variations in the energy band with the electric field within the semiconductor. The potential energy (<span class="math inline">\(P.E.\)</span>) of an electron (<span class="math inline">\(-q\)</span>) can be expressed as <span class="math inline">\(-qV\)</span>, where <span class="math inline">\(V\)</span> is the electrostatic potential at a given point with reference to an arbitrary constant. The potential can be expressed in terms of <span class="math inline">\(E_C\)</span> using the relationship shown previously between <span class="math inline">\(P.E.\)</span> and <span class="math inline">\(E_C\)</span>.</p>
<p><span class="math display">\[
P.E. = -qV = E_C - E_{ref}
\]</span></p>
<p><span class="math display">\[
V=-1/q(E_C - E_{ref})
\]</span></p>
<div id="fig-semi-dev-band-efield" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-semi-dev-band-efield-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/fig-semi-dev-band-efield.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-semi-dev-band-efield-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.6: Energy band diagrams for an uniform semiconductor sample in (a) zero and (b) non-zero electric field.
</figcaption>
</figure>
</div>
<p>The band diagram of a piece of semiconductor with the presence of an electric field <span class="math inline">\(E\)</span> is shown as an example in <a href="#fig-semi-dev-band-efield" class="quarto-xref">Figure&nbsp;<span>4.6</span></a> (b). The bands are <em>tilted</em> with a slope of <span class="math inline">\(-qE\)</span> popularly known as <em>band bending</em>. Since electrons are negatively charged, the direction of the forces on electrons is opposite to that of the electric field. The forces on the holes are in the same direction as the electric field. Consequently, the electrons and holes move in opposite directions.</p>
<p><span class="math display">\[
E=-\nabla V \text{ or,}
\]</span></p>
<p><span class="math display">\[
E_x = -dV/dx
\]</span></p>
<p><span class="math display">\[
E_x = \frac{1}{q}\frac{dE_C}{dx} \text{ or,}
\]</span></p>
<p><span class="math display">\[
E_x = \frac{1}{q}\frac{dE_V}{dx}  \text{ or,}
\]</span></p>
<p><span class="math display">\[
E_x = \frac{1}{q}\frac{dE_i}{dx}
\]</span></p>
<p>Using basic electrostatic laws, the relationship between the potential <span class="math inline">\(V\)</span> and electric field <span class="math inline">\(\vec{E}\)</span> can be established. For quick analysis by inspection, the <span class="math inline">\(V\)</span> and <span class="math inline">\(x\)</span> relationship can be found simply by “inverting” <span class="math inline">\(E_C\)</span> (or <span class="math inline">\(E_V\)</span>) and to determine the <span class="math inline">\(\vec{E}\)</span> versus <span class="math inline">\(x\)</span> relationship, simply note the slope of <span class="math inline">\(E_C\)</span> (or <span class="math inline">\(E_V\)</span>).</p>
<p>A pure semiconductor that contains an insignificant amount of impurity atoms is commonly referred to as <em>an intra-intrinsic semiconductor</em>. In other words, it is a semiconductor whose properties are native to the material without any external additives. In an intrinsic semiconductor, the electron concentration in the conduction band and the holes in the valence band are negligible compared to the number of available energy states within <span class="math inline">\(k_B T\)</span> from the edges of the band.</p>
<div id="tbl-semi-dev-ni-conc" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-semi-dev-ni-conc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4.2: Intrinsic electron-hole concentration of different semiconductor material at room temperature
</figcaption>
<div aria-describedby="tbl-semi-dev-ni-conc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead>
<tr class="header">
<th>Material</th>
<th><span class="math inline">\(n_i\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Si</td>
<td><span class="math inline">\(1\times 10^{10}/cm^3\)</span></td>
</tr>
<tr class="even">
<td>Ge</td>
<td><span class="math inline">\(2\times 10^{13}/cm^3\)</span></td>
</tr>
<tr class="odd">
<td>GaAs</td>
<td><span class="math inline">\(2\times 10^{6}/cm^3\)</span></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>In general, the number of electrons and holes per cubic-centimeter are defined as <span class="math inline">\(n\)</span> and <span class="math inline">\(p\)</span> respectively. Since electrons and holes are created in pairs in an intrinsic semiconductor, the concentrations of electrons and holes are the same and are represented as <span class="math inline">\(n_i\)</span> where <span class="math inline">\(n_i=n=p\)</span>. The intrinsic electron-hole concentrations in some popular semiconductor material are tabulated in <a href="#tbl-semi-dev-ni-conc" class="quarto-xref">Table&nbsp;<span>4.2</span></a>. Although the absolute concentration appears to be a large number, it is an insignificant number compared to the density of atoms in the material. For example, in silicon (Si) there are <span class="math inline">\(5\times 10^{22}~atoms/cm^3\)</span>. An intrinsic concentration of <span class="math inline">\(n_i\approx 10^{10}/cm^3\)</span> is less than <em>one broken bond</em> in <span class="math inline">\(10^{13}\)</span> atoms.</p>
<div id="tbl-semi-dev-si-dopants" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-semi-dev-si-dopants-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4.3: Common Silicon (Si) dopants. (*) Commonly used dopants. Donors and acceptors are all from the Column V and III of the Periodic Table of Elements respectively.
</figcaption>
<div aria-describedby="tbl-semi-dev-si-dopants-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead>
<tr class="header">
<th>Donors (V)</th>
<th>Acceptors (III)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(P^*\)</span></td>
<td><span class="math inline">\(B^*\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(As^*\)</span></td>
<td><span class="math inline">\(Ga\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(Sb\)</span></td>
<td><span class="math inline">\(In\)</span></td>
</tr>
<tr class="even">
<td></td>
<td><span class="math inline">\(Al\)</span></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</section>
<section id="doping" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="doping"><span class="header-section-number">4.5</span> Doping</h2>
<p>Doping is a semiconductor engineering method to change the electron or hole concentration of the native material by many orders of magnitude. As a result, the conductance of the semiconductor varies by a large magnitude. Doping is a routine method in IC fabrication in which semiconductor impurity atoms called <em>dopants</em> are added to the pure semiconductor material. Dopants that increase the electron concentration of the native semiconductor material are called <em>donors</em>. Consequently, <em>acceptors</em> are dopants that increase hole concentration.</p>
<div id="fig-semi-dev-viz-doping" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-semi-dev-viz-doping-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/fig-semi-dev-viz-doping.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-semi-dev-viz-doping-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.7: Visualization of (a) donor and (b) acceptor actions via the bonding model. In (a), <em>Column V</em> element P replaces a Si atom; in (b), Column III element B replaces a Si atom.
</figcaption>
</figure>
</div>
<p>Commonly used silicon dopants are listed in <a href="#tbl-semi-dev-si-dopants" class="quarto-xref">Table&nbsp;<span>4.3</span></a>. Phosphorous dopants, closely followed by arsenic, are the most commonly used donor dopants to increase the electron concentration. Boron is the most commonly used acceptor dopant for increasing hole concentration.</p>
<p>The donors are all from the Column-V of the Periodic Table of Elements and correspondingly, the acceptors are from Column-III.</p>
<p>As shown in <a href="#fig-semi-dev-viz-doping" class="quarto-xref">Figure&nbsp;<span>4.7</span></a>, using the bonding model, when a Column-V element replaces a silicon atom, four valence electrons bond with nearby silicon atoms, while the fifth is <em>weakly</em> bound to the donor site. At room temperature, this electron gains enough energy to become a conduction band carrier without increasing hole concentration, leaving an immobile ion.</p>
<p>The binding energy of a Phosphorous donor electron in silicon is about <span class="math inline">\(0.045~eV\)</span> compared to <span class="math inline">\(1~eV\)</span> for Si-Si atom.</p>
<p>A semiconductor doped with donors is called an <em>n-type</em> semiconductor.</p>
<p><span class="math inline">\(n+\)</span> and <span class="math inline">\(n-\)</span> refers to <em>heavily</em> and <em>lightly</em> doped n-type semiconductor.</p>
<p>At room temperature or above, each donor atom in an n-type semiconductor contributes one electron to the conduction band, making the electron concentration in the conduction band approximately equal to the donor concentration, typically expressed in <span class="math inline">\(atoms/cm^3\)</span>.</p>
<p>A Column-III acceptor element replaces a silicon atom, accepting an electron from a neighboring Si-Si bond to complete its bonding. This creates a hole that can move through the lattice, depicted as a hole weakly bound to the acceptor site.</p>
<p>The binding energy of a Boron acceptor hole in silicon is about <span class="math inline">\(0.045~eV\)</span>.</p>
<p>A semiconductor doped with an acceptor is called an <em>p-type</em> semiconductor. At room temperature or hotter temperatures, each acceptor atom in an p-type semiconductor supplies one hole to the valence band and therefore the hole concentration, <span class="math inline">\(p\)</span>, in the valence band is approximately equal to the acceptor concentration, <span class="math inline">\(N_A\)</span>, typically expressed in <span class="math inline">\(atoms/cm^3\)</span>.</p>
<p><span class="math inline">\(p+\)</span> and <span class="math inline">\(p-\)</span> refer to <em>heavily</em> and <em>lightly</em> doped n-type semiconductor, respectively.</p>
<p>An important relation used in the analysis of semiconductor devices is the <em>constant</em> product of hole and electron concentration, <span class="math inline">\(p\)</span> and <span class="math inline">\(n\)</span>, for a given temperature, which can be conveniently written as</p>
<p><span class="math display">\[
    np = n_i^2
\]</span></p>
<p>where, <span class="math inline">\(n_i\)</span> is the electron or hole concentration in an intrinsic semiconductor material at that temperature.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-pierret_semiconductor_1996" class="csl-entry" role="listitem">
Pierret, Robert F. 1996. <em>Semiconductor <span>Device</span> <span>Fundamentals</span></em>. Addison-Wesley.
</div>
<div id="ref-shur_introduction_1996" class="csl-entry" role="listitem">
Shur, Michael. 1996. <em>Introduction to <span>Electronic</span> <span>Devices</span></em>. Wiley.
</div>
<div id="ref-streetman_solid_2014" class="csl-entry" role="listitem">
Streetman, Ben, and Sanjay Banerjee. 2014. <em>Solid <span>State</span> <span>Electronic</span> <span>Devices</span></em>. Pearson Education.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./circuits.html" class="pagination-link" aria-label="Linear Circuits">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Linear Circuits</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./references.html" class="pagination-link" aria-label="References">
        <span class="nav-page-text">References</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>